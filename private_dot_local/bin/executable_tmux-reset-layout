#!/usr/bin/env bash

session=$(tmux display-message -p '#S')
dir=$(tmux display-message -p '#{session_path}')

# Capture existing window IDs
old_windows=$(tmux list-windows -t "$session" -F '#{window_id}')

# Create new windows
tmux new-window -t "$session" -n nvim -c "$dir"
tmux send-keys -t "$session:nvim" "nvim" Enter
tmux new-window -t "$session" -n claude -c "$dir"
tmux split-window -t "$session:claude" -h -c "$dir"
tmux new-window -t "$session" -n servers -c "$dir"
tmux select-window -t "$session:nvim"

# Kill old windows by ID
for wid in $old_windows; do
    tmux kill-window -t "$wid" 2>/dev/null
done
